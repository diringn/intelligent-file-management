# Intelligent File Management

## **О проекте**

**Intelligent File Management** — это система для мониторинга и автоматизации работы с файлами. Система способна в реальном времени отслеживать изменения в указанной директории, записывать логи в базу данных, а в перспективе выполнять набор автоматических действий (конвертация, переименование, резервное копирование и т.д.) по заданным правилам.

### **Текущая Версия: 0.0.2**

На **Втором Этапе** была реализована расширенная функциональность приложения на **Spring Boot**, включающая автоматические операции над файлами и управление правилами через REST API.

---

## **2. Новые Функции Во Второй Версии**

### **2.1. Автоматические Операции Над Файлами**

Теперь система способна автоматически выполнять следующие операции над файлами на основе заданных правил:

- **Перемещение (MOVE):** Автоматически перемещает файлы в целевую директорию по заданному расширению.
- **Переименование (RENAME):** Переименовывает файлы согласно указанному шаблону.
- **Конвертация (CONVERT):** Конвертирует файлы из одного формата в другой (например, PNG в JPG).

### **2.2. Управление Правилами Автоматизации Через REST API**

Добавлены эндпоинты для **CRUD-операций** с правилами автоматизации, позволяющие создавать, читать, обновлять и удалять правила без необходимости перезапуска приложения.

- **Создание Правила:** `POST /api/rules`
- **Получение Все Правил:** `GET /api/rules`
- **Получение Правила по ID:** `GET /api/rules/{id}`
- **Обновление Правила:** `PUT /api/rules/{id}`
- **Удаление Правила:** `DELETE /api/rules/{id}`

### **2.3. Реальная Конвертация Файлов**

Реализована конвертация изображений из формата **PNG** в **JPG** с использованием стандартной библиотеки **ImageIO**.

---

## **3. Как запустить**

1. **Склонируйте репозиторий:**

2. **Настройте базу данных** (PostgreSQL):

   - Создайте базу `file_management_db` и пользователя `file_user` с паролем `password` или используйте свои данные.

3. **Настройте `application.properties`:**

4. **Запустите приложение:**

   В корневой директории проекта выполните команду:

   ```bash
   ./mvnw spring-boot:run
   ```
   
5. **Проверьте запуск приложения:**

   Откройте браузер и перейдите по адресу: [http://localhost:8080/api/health](http://localhost:8080/api/health)

   Вы должны увидеть ответ:

   ```
   Intelligent File Management System is up and running!
   ```

---

## **4. Использование Новых Функций**

### **4.1. Управление Правилами Автоматизации**

Используйте REST API для создания, чтения, обновления и удаления правил автоматизации.

#### **4.1.1. Создание Правила**

**Endpoint:** `POST /api/rules`

**Пример запроса с использованием cURL:**

```bash
curl -X POST http://localhost:8080/api/rules \
     -H "Content-Type: application/json" \
     -d '{
           "name": "Move PDF Files",
           "description": "Автоматически перемещать все PDF-файлы в папку /Users/Nikita/Desktop/pdf",
           "fileExtension": "pdf",
           "operationType": "MOVE",
           "targetDirectory": "/Users/Nikita/Desktop/pdf",
           "renamePattern": null
         }'
```

#### **4.1.2. Получение Всех Правил**

**Endpoint:** `GET /api/rules`

**Пример запроса:**

```bash
curl http://localhost:8080/api/rules
```

#### **4.1.3. Обновление Правила**

**Endpoint:** `PUT /api/rules/{id}`

#### **4.1.4. Удаление Правила**

**Endpoint:** `DELETE /api/rules/{id}`

### **4.2. Автоматические Операции При Изменении Файлов**

После настройки правил, система будет автоматически выполнять соответствующие операции при обнаружении изменений в отслеживаемой директории.

#### **5.2.1. Пример Правил**

1. **Перемещение PDF-файлов:**

   - **Name:** Move PDF Files
   - **Description:** Автоматически перемещать все PDF-файлы в папку `/Users/Nikita/Desktop/pdf`
   - **File Extension:** pdf
   - **Operation Type:** MOVE
   - **Target Directory:** `/Users/Nikita/Desktop/pdf`
   - **Rename Pattern:** null

2. **Переименование TXT-файлов:**

   - **Name:** Rename TXT Files
   - **Description:** Автоматически переименовывать все TXT-файлы по шаблону `processed_{originalName}_{date}`
   - **File Extension:** txt
   - **Operation Type:** RENAME
   - **Target Directory:** null
   - **Rename Pattern:** `processed_{originalName}_{date}`

3. **Конвертация PNG в JPG:**

   - **Name:** PNG to JPG Converter
   - **Description:** Автоматически конвертировать все PNG-файлы в JPG и сохранять в папку `/Users/Nikita/Desktop/converted_images`
   - **File Extension:** png
   - **Operation Type:** CONVERT
   - **Target Directory:** `/Users/Nikita/Desktop/converted_images`
   - **Rename Pattern:** null

#### **4.2.2. Тестирование Операций**

1. **Перемещение PDF-файлов:**

   - Создайте папку назначения:
     ```bash
     mkdir -p /Users/Nikita/Desktop/pdf
     ```

   - Добавьте PDF-файл в отслеживаемую директорию:
     ```bash
     cp /path/to/sample.pdf /Users/Nikita/Desktop/testDirectory/
     ```

   - Проверьте, что файл автоматически перемещён в `/Users/Nikita/Desktop/pdf`.

2. **Переименование TXT-файлов:**

   - Создайте TXT-файл в отслеживаемой директории:
     ```bash
     echo "Hello, World!" > /Users/Nikita/Desktop/testDirectory/sample.txt
     ```

   - Проверьте, что файл переименован в `processed_sample_20250127_035038.txt` (дата и время будут актуальны).

3. **Конвертация PNG-файлов в JPG:**

   - Создайте папку назначения для конвертированных изображений:
     ```bash
     mkdir -p /Users/Nikita/Desktop/converted_images
     ```

   - Добавьте PNG-файл в отслеживаемую директорию:
     ```bash
     cp /path/to/sample.png /Users/Nikita/Desktop/testDirectory/
     ```

   - Проверьте, что файл `sample.jpg` появился в папке `/Users/Nikita/Desktop/converted_images`.

### **4.3. Просмотр Логов Событий**

Используйте эндпоинт `GET /api/logs` или подключитесь к базе данных PostgreSQL и выполните SQL-запрос для просмотра записей в таблице `file_logs`.

**Пример запроса через psql:**

```bash
psql -h localhost -U file_user -d file_management_db
```

Внутри psql выполните:

```sql
SELECT * FROM file_logs;
```

---

## **5. Что дальше**

На **следующих этапах** планируется существенно расширить функциональность проекта:

1. **Этап 3:**
   - **Расширенное управление правилами:**
      - Добавление условий (например, размер файла, дата создания).
      - Установка приоритетов правил.
   - **Интерфейс Пользователя:**
      - Разработка веб-интерфейса для управления правилами и мониторинга системы.

2. **Этап 4:**
   - **Планировщик Задач:**
      - Выполнение операций по расписанию.
   - **Уведомления и Оповещения:**
      - Отправка уведомлений по email или другим каналам при выполнении операций или возникновении ошибок.
   - **Подробные Логи и Журналирование:**
      - Хранение более детализированных логов для аудита и отладки.

3. **Этап 5:**
   - **Frontend Разработка:**
      - Создание полноценного веб-приложения (React/Angular/Vue) для взаимодействия с системой.
   - **Безопасность:**
      - Реализация аутентификации и авторизации пользователей с использованием Spring Security.
   - **Интеграция с Внешними Сервисами:**
      - Например, интеграция с облачными хранилищами или другими API.

---

## **6. Заключение**

Во **второй версии** проекта **Intelligent File Management** вы реализовали:

- **Автоматические операции над файлами:** перемещение, переименование и конвертация.
- **Управление правилами через REST API:** создание, чтение, обновление и удаление правил.
- **Реальная конвертация файлов:** пример конвертации PNG в JPG с использованием ImageIO.
- **Интеграция новых сервисов:** FileAutomationService для выполнения операций и обновлённый FileMonitorService для взаимодействия с ним.

Теперь вы можете **динамически настраивать правила автоматизации**, позволяя системе самостоятельно управлять файлами в указанной директории.